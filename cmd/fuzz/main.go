package main

// #cgo CFLAGS: -g -fsanitize=fuzzer,address
// #include "fuzz.h"
import "C"
import (
	"strconv"
	"strings"

	"github.com/PicoOrg/AndroidBox/internal/mprop"
	"github.com/PicoOrg/AndroidBox/internal/util"
	"golang.org/x/exp/maps"
	"golang.org/x/exp/rand"
)

var (
	propNames = map[string]string{
		"aaudio.hw_burst_min_usec":                                               "int",
		"aaudio.mmap_exclusive_policy":                                           "int",
		"aaudio.mmap_policy":                                                     "int",
		"aoj.feature.contract":                                                   "string",
		"aoj.feature.node_logging":                                               "string",
		"aoj.feature.ui_logging":                                                 "string",
		"apex.all.ready":                                                         "bool",
		"apexd.status":                                                           "enum starting activated ready",
		"audio.camerasound.force":                                                "bool",
		"audio.spatializer.effect.util_clamp_min":                                "int",
		"bluetooth.device.class_of_device":                                       "string",
		"bluetooth.leaudio.dual_bidirection_swb.supported":                       "string",
		"bluetooth.profile.a2dp.source.enabled":                                  "bool",
		"bluetooth.profile.asha.central.enabled":                                 "bool",
		"bluetooth.profile.avrcp.target.enabled":                                 "bool",
		"bluetooth.profile.bap.unicast.client.enabled":                           "bool",
		"bluetooth.profile.bas.client.enabled":                                   "bool",
		"bluetooth.profile.ccp.server.enabled":                                   "bool",
		"bluetooth.profile.csip.set_coordinator.enabled":                         "bool",
		"bluetooth.profile.gatt.enabled":                                         "bool",
		"bluetooth.profile.hap.client.enabled":                                   "bool",
		"bluetooth.profile.hfp.ag.enabled":                                       "bool",
		"bluetooth.profile.hid.device.enabled":                                   "bool",
		"bluetooth.profile.hid.host.enabled":                                     "bool",
		"bluetooth.profile.map.server.enabled":                                   "bool",
		"bluetooth.profile.mcp.server.enabled":                                   "bool",
		"bluetooth.profile.opp.enabled":                                          "bool",
		"bluetooth.profile.pan.nap.enabled":                                      "bool",
		"bluetooth.profile.pan.panu.enabled":                                     "bool",
		"bluetooth.profile.pbap.server.enabled":                                  "bool",
		"bluetooth.profile.sap.server.enabled":                                   "bool",
		"bluetooth.profile.vcp.controller.enabled":                               "bool",
		"bootreceiver.enable":                                                    "string",
		"bpf.progs_loaded":                                                       "bool",
		"build.version.extensions.ad_services":                                   "int",
		"build.version.extensions.r":                                             "int",
		"build.version.extensions.s":                                             "int",
		"build.version.extensions.t":                                             "int",
		"build.version.extensions.u":                                             "int",
		"cache_key.bluetooth.bluetooth_adapter_get_connection_state":             "string",
		"cache_key.bluetooth.bluetooth_adapter_get_profile_connection_state":     "string",
		"cache_key.bluetooth.bluetooth_adapter_get_state":                        "string",
		"cache_key.bluetooth.bluetooth_adapter_is_offloaded_filtering_supported": "string",
		"cache_key.bluetooth.bluetooth_device_get_bond_state":                    "string",
		"cache_key.bluetooth.bluetooth_map_get_connection_state":                 "string",
		"cache_key.bluetooth.bluetooth_sap_get_connection_state":                 "string",
		"cache_key.display_info":                                                 "string",
		"cache_key.get_packages_for_uid":                                         "string",
		"cache_key.has_system_feature":                                           "string",
		"cache_key.is_compat_change_enabled":                                     "string",
		"cache_key.is_interactive":                                               "string",
		"cache_key.is_power_save_mode":                                           "string",
		"cache_key.is_user_unlocked":                                             "string",
		"cache_key.location_enabled":                                             "string",
		"cache_key.package_info":                                                 "string",
		"cache_key.system_server.accounts_data":                                  "string",
		"cache_key.system_server.device_policy_manager_caches":                   "string",
		"cache_key.system_server.get_credential_type":                            "string",
		"cache_key.telephony.phone_account_to_subid":                             "string",
		"cache_key.telephony.subscription_manager_service":                       "string",
		"crashrecovery.rescue_boot_count":                                        "int",
		"dalvik.vm.appimageformat":                                               "string",
		"dalvik.vm.dex2oat-Xms":                                                  "string",
		"dalvik.vm.dex2oat-Xmx":                                                  "string",
		"dalvik.vm.dex2oat-max-image-block-size":                                 "int",
		"dalvik.vm.dex2oat-minidebuginfo":                                        "bool",
		"dalvik.vm.dex2oat-resolve-startup-strings":                              "bool",
		"dalvik.vm.dex2oat64.enabled":                                            "bool",
		"dalvik.vm.dexopt.secondary":                                             "bool",
		"dalvik.vm.dexopt.thermal-cutoff":                                        "int",
		"dalvik.vm.heapgrowthlimit":                                              "string",
		"dalvik.vm.heapmaxfree":                                                  "string",
		"dalvik.vm.heapminfree":                                                  "string",
		"dalvik.vm.heapsize":                                                     "string",
		"dalvik.vm.heapstartsize":                                                "string",
		"dalvik.vm.heaptargetutilization":                                        "string",
		"dalvik.vm.image-dex2oat-Xms":                                            "string",
		"dalvik.vm.image-dex2oat-Xmx":                                            "string",
		"dalvik.vm.isa.arm.features":                                             "string",
		"dalvik.vm.isa.arm.variant":                                              "string",
		"dalvik.vm.isa.arm64.features":                                           "string",
		"dalvik.vm.isa.arm64.variant":                                            "string",
		"dalvik.vm.madvise.artfile.size":                                         "string",
		"dalvik.vm.madvise.odexfile.size":                                        "string",
		"dalvik.vm.madvise.vdexfile.size":                                        "string",
		"dalvik.vm.minidebuginfo":                                                "string",
		"dalvik.vm.systemuicompilerfilter":                                       "string",
		"dalvik.vm.usap_pool_enabled":                                            "string",
		"dalvik.vm.usap_pool_refill_delay_ms":                                    "string",
		"dalvik.vm.usap_pool_size_max":                                           "string",
		"dalvik.vm.usap_pool_size_min":                                           "string",
		"dalvik.vm.usap_refill_threshold":                                        "string",
		"dalvik.vm.useartservice":                                                "string",
		"dalvik.vm.usejit":                                                       "bool",
		"debug.atrace.tags.enableflags":                                          "string",
		"debug.c2.use_dmabufheaps":                                               "string",
		"debug.force_rtl":                                                        "string",
		"debug.hwc.winupdate":                                                    "string",
		"debug.hwui.skia_tracing_enabled":                                        "string",
		"debug.hwui.skia_use_perfetto_track_events":                              "string",
		"debug.hwui.use_hint_manager":                                            "string",
		"debug.perfetto.sdk_sysprop_guard_generation":                            "string",
		"debug.renderengine.skia_tracing_enabled":                                "string",
		"debug.renderengine.skia_use_perfetto_track_events":                      "string",
		"debug.sf.dim_in_gamma_in_enhanced_screenshots":                          "string",
		"debug.sf.disable_backpressure":                                          "string",
		"debug.sf.early.app.duration":                                            "string",
		"debug.sf.early.sf.duration":                                             "string",
		"debug.sf.earlyGl.app.duration":                                          "string",
		"debug.sf.earlyGl.sf.duration":                                           "string",
		"debug.sf.enable_adpf_cpu_hint":                                          "string",
		"debug.sf.enable_gl_backpressure":                                        "string",
		"debug.sf.enable_sdr_dimming":                                            "string",
		"debug.sf.frame_rate_multiple_threshold":                                 "string",
		"debug.sf.late.app.duration":                                             "string",
		"debug.sf.late.sf.duration":                                              "string",
		"debug.sf.layer_caching_active_layer_timeout_ms":                         "string",
		"debug.sf.treat_170m_as_sRGB":                                            "string",
		"debug.sf.use_phase_offsets_as_durations":                                "string",
		"debug.slsi_platform":                                                    "string",
		"debug.stagefright.c2-poolmask":                                          "string",
		"debug.stagefright.c2inputsurface":                                       "string",
		"debug.stagefright.ccodec_delayed_params":                                "string",
		"debug.tracing.battery_status":                                           "string",
		"debug.tracing.device_state":                                             "string",
		"debug.tracing.plug_type":                                                "string",
		"debug.tracing.screen_brightness":                                        "string",
		"debug.tracing.screen_state":                                             "string",
		"dev.bootcomplete":                                                       "bool",
		"dev.mnt.blk.data":                                                       "string",
		"dev.mnt.blk.data.user.0":                                                "string",
		"dev.mnt.blk.data_mirror.cur_profiles":                                   "string",
		"dev.mnt.blk.data_mirror.data_ce.null":                                   "string",
		"dev.mnt.blk.data_mirror.data_ce.null.0":                                 "string",
		"dev.mnt.blk.data_mirror.data_de.null":                                   "string",
		"dev.mnt.blk.data_mirror.misc_ce.null":                                   "string",
		"dev.mnt.blk.data_mirror.misc_de.null":                                   "string",
		"dev.mnt.blk.data_mirror.ref_profiles":                                   "string",
		"dev.mnt.blk.metadata":                                                   "string",
		"dev.mnt.blk.mnt.vendor.efs":                                             "string",
		"dev.mnt.blk.mnt.vendor.efs_backup":                                      "string",
		"dev.mnt.blk.mnt.vendor.modem_img":                                       "string",
		"dev.mnt.blk.mnt.vendor.modem_userdata":                                  "string",
		"dev.mnt.blk.mnt.vendor.persist":                                         "string",
		"dev.mnt.blk.product":                                                    "string",
		"dev.mnt.blk.root":                                                       "string",
		"dev.mnt.blk.system_dlkm":                                                "string",
		"dev.mnt.blk.system_ext":                                                 "string",
		"dev.mnt.blk.vendor":                                                     "string",
		"dev.mnt.blk.vendor_dlkm":                                                "string",
		"dev.mnt.dev.data":                                                       "string",
		"dev.mnt.dev.data.user.0":                                                "string",
		"dev.mnt.dev.data_mirror.cur_profiles":                                   "string",
		"dev.mnt.dev.data_mirror.data_ce.null":                                   "string",
		"dev.mnt.dev.data_mirror.data_ce.null.0":                                 "string",
		"dev.mnt.dev.data_mirror.data_de.null":                                   "string",
		"dev.mnt.dev.data_mirror.misc_ce.null":                                   "string",
		"dev.mnt.dev.data_mirror.misc_de.null":                                   "string",
		"dev.mnt.dev.data_mirror.ref_profiles":                                   "string",
		"dev.mnt.dev.metadata":                                                   "string",
		"dev.mnt.dev.mnt.vendor.efs":                                             "string",
		"dev.mnt.dev.mnt.vendor.efs_backup":                                      "string",
		"dev.mnt.dev.mnt.vendor.modem_img":                                       "string",
		"dev.mnt.dev.mnt.vendor.modem_userdata":                                  "string",
		"dev.mnt.dev.mnt.vendor.persist":                                         "string",
		"dev.mnt.dev.product":                                                    "string",
		"dev.mnt.dev.root":                                                       "string",
		"dev.mnt.dev.system_dlkm":                                                "string",
		"dev.mnt.dev.system_ext":                                                 "string",
		"dev.mnt.dev.vendor":                                                     "string",
		"dev.mnt.dev.vendor_dlkm":                                                "string",
		"dev.mnt.rootdisk.data":                                                  "string",
		"dev.mnt.rootdisk.data.user.0":                                           "string",
		"dev.mnt.rootdisk.data_mirror.cur_profiles":                              "string",
		"dev.mnt.rootdisk.data_mirror.data_ce.null":                              "string",
		"dev.mnt.rootdisk.data_mirror.data_ce.null.0":                            "string",
		"dev.mnt.rootdisk.data_mirror.data_de.null":                              "string",
		"dev.mnt.rootdisk.data_mirror.misc_ce.null":                              "string",
		"dev.mnt.rootdisk.data_mirror.misc_de.null":                              "string",
		"dev.mnt.rootdisk.data_mirror.ref_profiles":                              "string",
		"dev.mnt.rootdisk.metadata":                                              "string",
		"dev.mnt.rootdisk.mnt.vendor.efs":                                        "string",
		"dev.mnt.rootdisk.mnt.vendor.efs_backup":                                 "string",
		"dev.mnt.rootdisk.mnt.vendor.modem_img":                                  "string",
		"dev.mnt.rootdisk.mnt.vendor.modem_userdata":                             "string",
		"dev.mnt.rootdisk.mnt.vendor.persist":                                    "string",
		"dev.mnt.rootdisk.product":                                               "string",
		"dev.mnt.rootdisk.root":                                                  "string",
		"dev.mnt.rootdisk.system_dlkm":                                           "string",
		"dev.mnt.rootdisk.system_ext":                                            "string",
		"dev.mnt.rootdisk.vendor":                                                "string",
		"dev.mnt.rootdisk.vendor_dlkm":                                           "string",
		"dmesgd.start":                                                           "bool",
		"drm.service.enabled":                                                    "bool",
		"euicc.seamless_transfer_enabled_in_non_qs":                              "string",
		"external_storage.casefold.enabled":                                      "bool",
		"external_storage.projid.enabled":                                        "bool",
		"external_storage.sdcardfs.enabled":                                      "bool",
		"framework_watchdog.fatal_count":                                         "int",
		"framework_watchdog.fatal_window.second":                                 "int",
		"graphics.gpu.profiler.support":                                          "bool",
		"gsid.image_installed":                                                   "string",
		"gsm.current.phone-type":                                                 "string",
		"gsm.network.type":                                                       "string",
		"gsm.operator.alpha":                                                     "string",
		"gsm.operator.iso-country":                                               "string",
		"gsm.operator.isroaming":                                                 "string",
		"gsm.operator.numeric":                                                   "string",
		"gsm.sim.state":                                                          "string",
		"gsm.version.baseband":                                                   "string",
		"gsm.version.ril-impl":                                                   "string",
		"hwservicemanager.ready":                                                 "string",
		"init.svc.BIP-Channel-Manager":                                           "string",
		"init.svc.DM-daemon":                                                     "string",
		"init.svc.RFS-daemon":                                                    "string",
		"init.svc.adbd":                                                          "string",
		"init.svc.android-hardware-media-c2-hal-1-0-google":                      "string",
		"init.svc.android-hardware-media-c2-hal-1-2":                             "string",
		"init.svc.aocd":                                                          "string",
		"init.svc.aocxd":                                                         "string",
		"init.svc.apexd":                                                         "string",
		"init.svc.apexd-bootstrap":                                               "string",
		"init.svc.apexd-snapshotde":                                              "string",
		"init.svc.art_boot":                                                      "string",
		"init.svc.artd":                                                          "string",
		"init.svc.audiometricext":                                                "string",
		"init.svc.audioserver":                                                   "string",
		"init.svc.bcmbtlinux":                                                    "string",
		"init.svc.bootanim":                                                      "string",
		"init.svc.boringssl_self_test64":                                         "string",
		"init.svc.boringssl_self_test64_vendor":                                  "string",
		"init.svc.boringssl_self_test_apex64":                                    "string",
		"init.svc.bpfloader":                                                     "string",
		"init.svc.cameraserver":                                                  "string",
		"init.svc.cpboot-daemon":                                                 "string",
		"init.svc.credstore":                                                     "string",
		"init.svc.derive_classpath":                                              "string",
		"init.svc.derive_sdk":                                                    "string",
		"init.svc.dmesgd":                                                        "string",
		"init.svc.drm":                                                           "string",
		"init.svc.edgetpu_app_service":                                           "string",
		"init.svc.edgetpu_logging":                                               "string",
		"init.svc.edgetpu_vendor_service":                                        "string",
		"init.svc.gatekeeperd":                                                   "string",
		"init.svc.gnss_service":                                                  "string",
		"init.svc.google_battery":                                                "string",
		"init.svc.gpsd":                                                          "string",
		"init.svc.gpu":                                                           "string",
		"init.svc.gs_watchdogd":                                                  "string",
		"init.svc.gto_secure_element_hal_service_1_2":                            "string",
		"init.svc.gto_secure_element_hal_service_ese2_1_2":                       "string",
		"init.svc.gxp_logging":                                                   "string",
		"init.svc.hal_neuralnetworks_darwinn":                                    "string",
		"init.svc.heapprofd":                                                     "string",
		"init.svc.hidl_memory":                                                   "string",
		"init.svc.hwservicemanager":                                              "string",
		"init.svc.idmap2d":                                                       "string",
		"init.svc.incidentd":                                                     "string",
		"init.svc.init-radio-sh":                                                 "string",
		"init.svc.init_display":                                                  "string",
		"init.svc.insmod_sh":                                                     "string",
		"init.svc.insmod_sh_pantah":                                              "string",
		"init.svc.installd":                                                      "string",
		"init.svc.keystore2":                                                     "string",
		"init.svc.lhd":                                                           "string",
		"init.svc.lmkd":                                                          "string",
		"init.svc.logd":                                                          "string",
		"init.svc.logd-auditctl":                                                 "string",
		"init.svc.logd-reinit":                                                   "string",
		"init.svc.media":                                                         "string",
		"init.svc.media.swcodec":                                                 "string",
		"init.svc.mediadrm":                                                      "string",
		"init.svc.mediaextractor":                                                "string",
		"init.svc.mediametrics":                                                  "string",
		"init.svc.misctrl":                                                       "string",
		"init.svc.modem_logging_enabled_change":                                  "string",
		"init.svc.netd":                                                          "string",
		"init.svc.nfc_hal_service":                                               "string",
		"init.svc.odsign":                                                        "string",
		"init.svc.pktrouter":                                                     "string",
		"init.svc.prng_seeder":                                                   "string",
		"init.svc.ril-daemon":                                                    "string",
		"init.svc.rlsservice":                                                    "string",
		"init.svc.scd":                                                           "string",
		"init.svc.secure_element_uicc_hal_service":                               "string",
		"init.svc.securedpud.slider":                                             "string",
		"init.svc.servicemanager":                                                "string",
		"init.svc.statsd":                                                        "string",
		"init.svc.storaged":                                                      "string",
		"init.svc.storageproxyd":                                                 "string",
		"init.svc.surfaceflinger":                                                "string",
		"init.svc.system_suspend":                                                "string",
		"init.svc.tombstoned":                                                    "string",
		"init.svc.traced":                                                        "string",
		"init.svc.traced_perf":                                                   "string",
		"init.svc.traced_probes":                                                 "string",
		"init.svc.trusty_metricsd":                                               "string",
		"init.svc.twoshay":                                                       "string",
		"init.svc.ueventd":                                                       "string",
		"init.svc.ufs_firmware_update":                                           "string",
		"init.svc.update_engine":                                                 "string",
		"init.svc.update_verifier":                                               "string",
		"init.svc.usbd":                                                          "string",
		"init.svc.vendor-dolby-media-c2-hal-1-0":                                 "string",
		"init.svc.vendor.audio-hal":                                              "string",
		"init.svc.vendor.authsecret_hal_aidl":                                    "string",
		"init.svc.vendor.battery_mitigation":                                     "string",
		"init.svc.vendor.boot-default":                                           "string",
		"init.svc.vendor.camera-provider-2-7-google":                             "string",
		"init.svc.vendor.cas-default":                                            "string",
		"init.svc.vendor.cas-hal-1-2":                                            "string",
		"init.svc.vendor.citadeld":                                               "string",
		"init.svc.vendor.confirmationui_default":                                 "string",
		"init.svc.vendor.contexthub-default":                                     "string",
		"init.svc.vendor.drm-clearkey-service":                                   "string",
		"init.svc.vendor.drm-widevine-hal":                                       "string",
		"init.svc.vendor.dumpstate-default":                                      "string",
		"init.svc.vendor.face-hal":                                               "string",
		"init.svc.vendor.fingerprint-goodix":                                     "string",
		"init.svc.vendor.gatekeeper_default":                                     "string",
		"init.svc.vendor.google.radioext@1.0":                                    "string",
		"init.svc.vendor.graphics.allocator-default":                             "string",
		"init.svc.vendor.health-gs201":                                           "string",
		"init.svc.vendor.hwcomposer-3":                                           "string",
		"init.svc.vendor.identity_hal":                                           "string",
		"init.svc.vendor.init_citadel":                                           "string",
		"init.svc.vendor.input.processor":                                        "string",
		"init.svc.vendor.keymint-citadel":                                        "string",
		"init.svc.vendor.keymint-trusty":                                         "string",
		"init.svc.vendor.memtrack-default":                                       "string",
		"init.svc.vendor.modem_svc_sit":                                          "string",
		"init.svc.vendor.oemlock_hal_aidl":                                       "string",
		"init.svc.vendor.pixelstats_vendor":                                      "string",
		"init.svc.vendor.power-hal-aidl":                                         "string",
		"init.svc.vendor.power.stats":                                            "string",
		"init.svc.vendor.rebalance_interrupts-vendor":                            "string",
		"init.svc.vendor.sensors-hal-multihal":                                   "string",
		"init.svc.vendor.sscoredump":                                             "string",
		"init.svc.vendor.theme_set":                                              "string",
		"init.svc.vendor.thermal-hal":                                            "string",
		"init.svc.vendor.thermal.symlinks":                                       "string",
		"init.svc.vendor.usb":                                                    "string",
		"init.svc.vendor.usb-gadget-hal":                                         "string",
		"init.svc.vendor.vibrator.cs40l26":                                       "string",
		"init.svc.vendor.weaver_hal_aidl":                                        "string",
		"init.svc.vendor.wifi_hal_legacy":                                        "string",
		"init.svc.vndservicemanager":                                             "string",
		"init.svc.vold":                                                          "string",
		"init.svc.wificond":                                                      "string",
		"init.svc.wireless_charger_AIDL":                                         "string",
		"init.svc.wpa_supplicant":                                                "string",
		"init.svc.zygote":                                                        "string",
		"init.svc_debug_pid.BIP-Channel-Manager":                                 "string",
		"init.svc_debug_pid.DM-daemon":                                           "string",
		"init.svc_debug_pid.RFS-daemon":                                          "string",
		"init.svc_debug_pid.adbd":                                                "string",
		"init.svc_debug_pid.android-hardware-media-c2-hal-1-0-google":            "string",
		"init.svc_debug_pid.android-hardware-media-c2-hal-1-2":                   "string",
		"init.svc_debug_pid.aocd":                                                "string",
		"init.svc_debug_pid.aocxd":                                               "string",
		"init.svc_debug_pid.apexd":                                               "string",
		"init.svc_debug_pid.apexd-bootstrap":                                     "string",
		"init.svc_debug_pid.apexd-snapshotde":                                    "string",
		"init.svc_debug_pid.art_boot":                                            "string",
		"init.svc_debug_pid.artd":                                                "string",
		"init.svc_debug_pid.audiometricext":                                      "string",
		"init.svc_debug_pid.audioserver":                                         "string",
		"init.svc_debug_pid.bcmbtlinux":                                          "string",
		"init.svc_debug_pid.bootanim":                                            "string",
		"init.svc_debug_pid.boringssl_self_test64":                               "string",
		"init.svc_debug_pid.boringssl_self_test64_vendor":                        "string",
		"init.svc_debug_pid.boringssl_self_test_apex64":                          "string",
		"init.svc_debug_pid.bpfloader":                                           "string",
		"init.svc_debug_pid.cameraserver":                                        "string",
		"init.svc_debug_pid.cpboot-daemon":                                       "string",
		"init.svc_debug_pid.credstore":                                           "string",
		"init.svc_debug_pid.derive_classpath":                                    "string",
		"init.svc_debug_pid.derive_sdk":                                          "string",
		"init.svc_debug_pid.dmesgd":                                              "string",
		"init.svc_debug_pid.drm":                                                 "string",
		"init.svc_debug_pid.edgetpu_app_service":                                 "string",
		"init.svc_debug_pid.edgetpu_logging":                                     "string",
		"init.svc_debug_pid.edgetpu_vendor_service":                              "string",
		"init.svc_debug_pid.gatekeeperd":                                         "string",
		"init.svc_debug_pid.gnss_service":                                        "string",
		"init.svc_debug_pid.google_battery":                                      "string",
		"init.svc_debug_pid.gpsd":                                                "string",
		"init.svc_debug_pid.gpu":                                                 "string",
		"init.svc_debug_pid.gs_watchdogd":                                        "string",
		"init.svc_debug_pid.gto_secure_element_hal_service_1_2":                  "string",
		"init.svc_debug_pid.gto_secure_element_hal_service_ese2_1_2":             "string",
		"init.svc_debug_pid.gxp_logging":                                         "string",
		"init.svc_debug_pid.hal_neuralnetworks_darwinn":                          "string",
		"init.svc_debug_pid.heapprofd":                                           "string",
		"init.svc_debug_pid.hidl_memory":                                         "string",
		"init.svc_debug_pid.hwservicemanager":                                    "string",
		"init.svc_debug_pid.idmap2d":                                             "string",
		"init.svc_debug_pid.incidentd":                                           "string",
		"init.svc_debug_pid.init-radio-sh":                                       "string",
		"init.svc_debug_pid.init_display":                                        "string",
		"init.svc_debug_pid.insmod_sh":                                           "string",
		"init.svc_debug_pid.insmod_sh_pantah":                                    "string",
		"init.svc_debug_pid.installd":                                            "string",
		"init.svc_debug_pid.keystore2":                                           "string",
		"init.svc_debug_pid.lhd":                                                 "string",
		"init.svc_debug_pid.lmkd":                                                "string",
		"init.svc_debug_pid.logd":                                                "string",
		"init.svc_debug_pid.logd-auditctl":                                       "string",
		"init.svc_debug_pid.logd-reinit":                                         "string",
		"init.svc_debug_pid.media":                                               "string",
		"init.svc_debug_pid.media.swcodec":                                       "string",
		"init.svc_debug_pid.mediaextractor":                                      "string",
		"init.svc_debug_pid.mediametrics":                                        "string",
		"init.svc_debug_pid.misctrl":                                             "string",
		"init.svc_debug_pid.modem_logging_enabled_change":                        "string",
		"init.svc_debug_pid.netd":                                                "string",
		"init.svc_debug_pid.nfc_hal_service":                                     "string",
		"init.svc_debug_pid.odsign":                                              "string",
		"init.svc_debug_pid.pktrouter":                                           "string",
		"init.svc_debug_pid.prng_seeder":                                         "string",
		"init.svc_debug_pid.ril-daemon":                                          "string",
		"init.svc_debug_pid.rlsservice":                                          "string",
		"init.svc_debug_pid.scd":                                                 "string",
		"init.svc_debug_pid.secure_element_uicc_hal_service":                     "string",
		"init.svc_debug_pid.securedpud.slider":                                   "string",
		"init.svc_debug_pid.servicemanager":                                      "string",
		"init.svc_debug_pid.statsd":                                              "string",
		"init.svc_debug_pid.storaged":                                            "string",
		"init.svc_debug_pid.storageproxyd":                                       "string",
		"init.svc_debug_pid.surfaceflinger":                                      "string",
		"init.svc_debug_pid.system_suspend":                                      "string",
		"init.svc_debug_pid.tombstoned":                                          "string",
		"init.svc_debug_pid.traced":                                              "string",
		"init.svc_debug_pid.traced_perf":                                         "string",
		"init.svc_debug_pid.traced_probes":                                       "string",
		"init.svc_debug_pid.trusty_metricsd":                                     "string",
		"init.svc_debug_pid.twoshay":                                             "string",
		"init.svc_debug_pid.ueventd":                                             "string",
		"init.svc_debug_pid.ufs_firmware_update":                                 "string",
		"init.svc_debug_pid.update_engine":                                       "string",
		"init.svc_debug_pid.update_verifier":                                     "string",
		"init.svc_debug_pid.usbd":                                                "string",
		"init.svc_debug_pid.vendor-dolby-media-c2-hal-1-0":                       "string",
		"init.svc_debug_pid.vendor.audio-hal":                                    "string",
		"init.svc_debug_pid.vendor.authsecret_hal_aidl":                          "string",
		"init.svc_debug_pid.vendor.battery_mitigation":                           "string",
		"init.svc_debug_pid.vendor.boot-default":                                 "string",
		"init.svc_debug_pid.vendor.camera-provider-2-7-google":                   "string",
		"init.svc_debug_pid.vendor.cas-default":                                  "string",
		"init.svc_debug_pid.vendor.cas-hal-1-2":                                  "string",
		"init.svc_debug_pid.vendor.citadeld":                                     "string",
		"init.svc_debug_pid.vendor.confirmationui_default":                       "string",
		"init.svc_debug_pid.vendor.contexthub-default":                           "string",
		"init.svc_debug_pid.vendor.drm-clearkey-service":                         "string",
		"init.svc_debug_pid.vendor.drm-widevine-hal":                             "string",
		"init.svc_debug_pid.vendor.dumpstate-default":                            "string",
		"init.svc_debug_pid.vendor.face-hal":                                     "string",
		"init.svc_debug_pid.vendor.fingerprint-goodix":                           "string",
		"init.svc_debug_pid.vendor.gatekeeper_default":                           "string",
		"init.svc_debug_pid.vendor.google.radioext@1.0":                          "string",
		"init.svc_debug_pid.vendor.graphics.allocator-default":                   "string",
		"init.svc_debug_pid.vendor.health-gs201":                                 "string",
		"init.svc_debug_pid.vendor.hwcomposer-3":                                 "string",
		"init.svc_debug_pid.vendor.identity_hal":                                 "string",
		"init.svc_debug_pid.vendor.init_citadel":                                 "string",
		"init.svc_debug_pid.vendor.input.processor":                              "string",
		"init.svc_debug_pid.vendor.keymint-citadel":                              "string",
		"init.svc_debug_pid.vendor.keymint-trusty":                               "string",
		"init.svc_debug_pid.vendor.memtrack-default":                             "string",
		"init.svc_debug_pid.vendor.modem_svc_sit":                                "string",
		"init.svc_debug_pid.vendor.oemlock_hal_aidl":                             "string",
		"init.svc_debug_pid.vendor.pixelstats_vendor":                            "string",
		"init.svc_debug_pid.vendor.power-hal-aidl":                               "string",
		"init.svc_debug_pid.vendor.power.stats":                                  "string",
		"init.svc_debug_pid.vendor.rebalance_interrupts-vendor":                  "string",
		"init.svc_debug_pid.vendor.sensors-hal-multihal":                         "string",
		"init.svc_debug_pid.vendor.sscoredump":                                   "string",
		"init.svc_debug_pid.vendor.theme_set":                                    "string",
		"init.svc_debug_pid.vendor.thermal-hal":                                  "string",
		"init.svc_debug_pid.vendor.thermal.symlinks":                             "string",
		"init.svc_debug_pid.vendor.usb":                                          "string",
		"init.svc_debug_pid.vendor.usb-gadget-hal":                               "string",
		"init.svc_debug_pid.vendor.vibrator.cs40l26":                             "string",
		"init.svc_debug_pid.vendor.weaver_hal_aidl":                              "string",
		"init.svc_debug_pid.vendor.wifi_hal_legacy":                              "string",
		"init.svc_debug_pid.vndservicemanager":                                   "string",
		"init.svc_debug_pid.vold":                                                "string",
		"init.svc_debug_pid.wificond":                                            "string",
		"init.svc_debug_pid.wireless_charger_AIDL":                               "string",
		"init.svc_debug_pid.wpa_supplicant":                                      "string",
		"init.svc_debug_pid.zygote":                                              "string",
		"keyguard.no_require_sim":                                                "bool",
		"keystore.boot_level":                                                    "int",
		"keystore.crash_count":                                                   "int",
		"khungtask.enable":                                                       "string",
		"llk.enable":                                                             "string",
		"log.tag.APM_AudioPolicyManager":                                         "string",
		"log.tag.GABC":                                                           "string",
		"log.tag.GAF":                                                            "string",
		"log.tag.GHAWB":                                                          "string",
		"log.tag.stats_log":                                                      "string",
		"logd.ready":                                                             "string",
		"masterclear.allow_retain_esim_profiles_after_fdr":                       "string",
		"media.c2.dmabuf.padding":                                                "int",
		"media.mediadrmservice.enable":                                           "bool",
		"net.bt.name":                                                            "string",
		"net.tcp_def_init_rwnd":                                                  "int",
		"nfc.initialized":                                                        "string",
		"odsign.key.done":                                                        "bool",
		"odsign.verification.done":                                               "bool",
		"odsign.verification.success":                                            "bool",
		"partition.product.verified":                                             "string",
		"partition.product.verified.check_at_most_once":                          "string",
		"partition.product.verified.hash_alg":                                    "string",
		"partition.product.verified.root_digest":                                 "string",
		"partition.system.verified":                                              "string",
		"partition.system.verified.check_at_most_once":                           "string",
		"partition.system.verified.hash_alg":                                     "string",
		"partition.system.verified.root_digest":                                  "string",
		"partition.system_dlkm.verified":                                         "string",
		"partition.system_dlkm.verified.check_at_most_once":                      "string",
		"partition.system_dlkm.verified.hash_alg":                                "string",
		"partition.system_dlkm.verified.root_digest":                             "string",
		"partition.system_ext.verified":                                          "string",
		"partition.system_ext.verified.check_at_most_once":                       "string",
		"partition.system_ext.verified.hash_alg":                                 "string",
		"partition.system_ext.verified.root_digest":                              "string",
		"partition.vendor.verified":                                              "string",
		"partition.vendor.verified.check_at_most_once":                           "string",
		"partition.vendor.verified.hash_alg":                                     "string",
		"partition.vendor.verified.root_digest":                                  "string",
		"partition.vendor_dlkm.verified":                                         "string",
		"partition.vendor_dlkm.verified.check_at_most_once":                      "string",
		"partition.vendor_dlkm.verified.hash_alg":                                "string",
		"partition.vendor_dlkm.verified.root_digest":                             "string",
		"persist.bluetooth.a2dp_aac.vbr_supported":                               "string",
		"persist.bluetooth.a2dp_offload.cap":                                     "string",
		"persist.bluetooth.a2dp_offload.disabled":                                "bool",
		"persist.bluetooth.bqr.event_mask":                                       "string",
		"persist.bluetooth.bqr.min_interval_ms":                                  "string",
		"persist.bluetooth.btsnoopdefaultmode":                                   "enum empty disabled filtered full",
		"persist.bluetooth.firmware.download":                                    "string",
		"persist.bluetooth.firmware.selection":                                   "string",
		"persist.bluetooth.leaudio.allow_list":                                   "string",
		"persist.bluetooth.leaudio.notify.idle.during.call":                      "string",
		"persist.bluetooth.leaudio_offload.disabled":                             "bool",
		"persist.bluetooth.opus.enabled":                                         "string",
		"persist.bootanim.color1":                                                "int",
		"persist.bootanim.color2":                                                "int",
		"persist.bootanim.color3":                                                "int",
		"persist.bootanim.color4":                                                "int",
		"persist.device_config.attempted_boot_count":                             "string",
		"persist.radio.csc.clir_aoc_0":                                           "string",
		"persist.radio.is_vonr_enabled_0":                                        "string",
		"persist.radio.multisim.config":                                          "string",
		"persist.radio.reboot_on_modem_change":                                   "string",
		"persist.radio.uim.remote.mcc":                                           "string",
		"persist.radio.uim.remote.slot":                                          "string",
		"persist.settings.large_screen_opt.enabled":                              "string",
		"persist.sys.boot.reason":                                                "string",
		"persist.sys.boot.reason.history":                                        "string",
		"persist.sys.dalvik.vm.lib.2":                                            "string",
		"persist.sys.device_provisioned":                                         "string",
		"persist.sys.displayinset.top":                                           "string",
		"persist.sys.fuse":                                                       "string",
		"persist.sys.fuse.passthrough.enable":                                    "string",
		"persist.sys.gps.lpp":                                                    "string",
		"persist.sys.lmk.reportkills":                                            "string",
		"persist.sys.locale":                                                     "string",
		"persist.sys.sf.color_saturation":                                        "string",
		"persist.sys.sf.native_mode":                                             "int",
		"persist.sys.theme":                                                      "string",
		"persist.sys.time.offset":                                                "string",
		"persist.sys.timezone":                                                   "string",
		"persist.sys.timezone_confidence":                                        "uint",
		"persist.sys.usb.config":                                                 "string",
		"persist.traced.enable":                                                  "string",
		"persist.vendor.audio.cca.enabled":                                       "string",
		"persist.vendor.camera.exif_reveal_make_model":                           "string",
		"persist.vendor.camera.front_720P_always_binning":                        "string",
		"persist.vendor.enable.thermal.genl":                                     "string",
		"persist.vendor.modem.baseband.version":                                  "string",
		"persist.vendor.modem.efs.clear.action":                                  "string",
		"persist.vendor.modem.experiment.volte_mif_off":                          "string",
		"persist.vendor.nfc.streset":                                             "string",
		"persist.vendor.radio.call_waiting_for_sync_0":                           "string",
		"persist.vendor.radio.config.carrier_config_dir":                         "string",
		"persist.vendor.radio.cp.hw.version":                                     "string",
		"persist.vendor.radio.dds":                                               "string",
		"persist.vendor.radio.multisim_switch_support":                           "string",
		"persist.vendor.radio.target_oper":                                       "string",
		"persist.vendor.ril.camp_on_earlier":                                     "string",
		"persist.vendor.ril.crash_handling_mode":                                 "string",
		"persist.vendor.ril.db_ecc.id.type":                                      "string",
		"persist.vendor.ril.db_ecc.use.iccid_to_plmn":                            "string",
		"persist.vendor.ril.ecc.use.xml":                                         "string",
		"persist.vendor.ril.enable_set_screen_state":                             "string",
		"persist.vendor.ril.log.base_dir":                                        "string",
		"persist.vendor.ril.log.chunk_size":                                      "string",
		"persist.vendor.ril.log.num_file":                                        "string",
		"persist.vendor.ril.log_mask":                                            "string",
		"persist.vendor.ril.sim1.disabled_iccid":                                 "string",
		"persist.vendor.ril.sim1.oc_name_id":                                     "string",
		"persist.vendor.ril.support_nr_ds":                                       "string",
		"persist.vendor.ril.use_radio_hal":                                       "string",
		"persist.vendor.se.chip2.osversion":                                      "string",
		"persist.vendor.se.dkaversion":                                           "string",
		"persist.vendor.se.ese.jpki":                                             "string",
		"persist.vendor.se.ese.jpki.status":                                      "string",
		"persist.vendor.se.ese2.mode":                                            "string",
		"persist.vendor.se.osversion":                                            "string",
		"persist.vendor.se.reset":                                                "string",
		"persist.vendor.se.sraversion":                                           "string",
		"persist.vendor.se.streset":                                              "string",
		"persist.vendor.se.susaversion":                                          "string",
		"persist.vendor.sys.modem.logging.br_num":                                "string",
		"persist.vendor.sys.modem.logging.enable":                                "string",
		"persist.vendor.testing_battery_profile":                                 "string",
		"persist.vendor.udfps.als_feed_forward_supported":                        "string",
		"persist.vendor.udfps.lhbm_controlled_in_hal_supported":                  "string",
		"persist.vendor.verbose_logging_enabled":                                 "string",
		"persist.vendor.vibrator.hal.chirp.enabled":                              "string",
		"persist.vendor.vibrator.hal.context.cooldowntime":                       "string",
		"persist.vendor.vibrator.hal.context.enable":                             "string",
		"persist.vendor.vibrator.hal.context.fade":                               "string",
		"persist.vendor.vibrator.hal.context.scale":                              "string",
		"persist.vendor.vibrator.hal.context.settlingtime":                       "string",
		"pm.dexopt.ab-ota":                                                       "string",
		"pm.dexopt.bg-dexopt":                                                    "string",
		"pm.dexopt.boot-after-mainline-update":                                   "string",
		"pm.dexopt.boot-after-ota":                                               "string",
		"pm.dexopt.cmdline":                                                      "string",
		"pm.dexopt.first-boot":                                                   "string",
		"pm.dexopt.inactive":                                                     "string",
		"pm.dexopt.install":                                                      "string",
		"pm.dexopt.install-bulk":                                                 "string",
		"pm.dexopt.install-bulk-downgraded":                                      "string",
		"pm.dexopt.install-bulk-secondary":                                       "string",
		"pm.dexopt.install-bulk-secondary-downgraded":                            "string",
		"pm.dexopt.install-fast":                                                 "string",
		"pm.dexopt.post-boot":                                                    "string",
		"pm.dexopt.shared":                                                       "string",
		"remote_provisioning.hostname":                                           "string",
		"repair_mode.init_completed.0":                                           "bool",
		"security.perf_harden":                                                   "string",
		"selinux.restorecon_recursive":                                           "string",
		"service.bootanim.exit":                                                  "int",
		"service.bootanim.progress":                                              "int",
		"service.sf.present_timestamp":                                           "string",
		"servicemanager.ready":                                                   "bool",
		"setupwizard.feature.baseline_setupwizard_enabled":                       "bool",
		"setupwizard.feature.day_night_mode_enabled":                             "bool",
		"setupwizard.feature.enable_gil":                                         "string",
		"setupwizard.feature.enable_wifi_tracker":                                "string",
		"setupwizard.feature.lifecycle_refactoring":                              "string",
		"setupwizard.feature.notification_refactoring":                           "string",
		"setupwizard.feature.portal_notification":                                "bool",
		"setupwizard.feature.show_digital_warranty":                              "string",
		"setupwizard.feature.show_pai_screen_in_main_flow.carrier1839":           "string",
		"setupwizard.feature.show_pixel_tos":                                     "bool",
		"setupwizard.feature.show_support_link_in_deferred_setup":                "string",
		"setupwizard.feature.skip_button_use_mobile_data.carrier1839":            "string",
		"setupwizard.theme":                                                      "string",
		"suspend.max_sleep_time_millis":                                          "uint",
		"suspend.short_suspend_backoff_enabled":                                  "bool",
		"suspend.short_suspend_threshold_millis":                                 "uint",
		"sys.boot.reason":                                                        "string",
		"sys.boot.reason.last":                                                   "string",
		"sys.boot_completed":                                                     "bool",
		"sys.bootstat.first_boot_completed":                                      "string",
		"sys.fuse.transcode_enabled":                                             "string",
		"sys.init.perf_lsm_hooks":                                                "string",
		"sys.lmk.minfree_levels":                                                 "string",
		"sys.lmk.reportkills":                                                    "string",
		"sys.oem_unlock_allowed":                                                 "string",
		"sys.retaildemo.enabled":                                                 "int",
		"sys.sysctl.extra_free_kbytes":                                           "string",
		"sys.system_server.start_count":                                          "string",
		"sys.system_server.start_elapsed":                                        "string",
		"sys.system_server.start_uptime":                                         "string",
		"sys.trace.traced_started":                                               "string",
		"sys.usb.config":                                                         "string",
		"sys.usb.configfs":                                                       "int",
		"sys.usb.controller":                                                     "string",
		"sys.usb.ffs.ready":                                                      "bool",
		"sys.usb.mtp.batchcancel":                                                "bool",
		"sys.usb.mtp.device_type":                                                "int",
		"sys.use_memfd":                                                          "bool",
		"sys.user.0.ce_available":                                                "bool",
		"sys.wifitracing.started":                                                "string",
		"telephony.active_modems.max_count":                                      "int",
		"vendor.all.devices.ready":                                               "string",
		"vendor.all.modules.ready":                                               "string",
		"vendor.aoc.firmware.version":                                            "string",
		"vendor.battery.defender.state":                                          "string",
		"vendor.brownout.mitigation.ready":                                       "string",
		"vendor.camera.hal.build_id":                                             "string",
		"vendor.camera.hal.ready.count":                                          "string",
		"vendor.camera.hal.start.count":                                          "string",
		"vendor.camera.hal.version":                                              "string",
		"vendor.camera.max_flash_current":                                        "string",
		"vendor.cbd.boot_done":                                                   "string",
		"vendor.cbd.partition":                                                   "string",
		"vendor.chre.multiclient_hal.enabled":                                    "string",
		"vendor.common.modules.ready":                                            "string",
		"vendor.debug.ssrdump.type":                                              "string",
		"vendor.device.modules.ready":                                            "string",
		"vendor.display.lbe.supported":                                           "string",
		"vendor.edgetpu.cpu_scheduler.policy":                                    "string",
		"vendor.edgetpu.cpu_scheduler.priority":                                  "string",
		"vendor.edgetpu.tflite_delegate.force_disable_io_coherency":              "string",
		"vendor.gf.cali.state":                                                   "string",
		"vendor.hwc.dpp.downscale":                                               "string",
		"vendor.mali.base_protected_max_core_count":                              "string",
		"vendor.mali.base_protected_tls_max":                                     "string",
		"vendor.mali.debug.config":                                               "string",
		"vendor.mali.platform.config":                                            "string",
		"vendor.mali.platform_agt_frequency_khz":                                 "string",
		"vendor.media.omx":                                                       "string",
		"vendor.modem.bin.path":                                                  "string",
		"vendor.modem.rf_cfg.chosen.path":                                        "string",
		"vendor.nos.citadel.version":                                             "string",
		"vendor.pktrouter":                                                       "string",
		"vendor.powerhal.camerarunning":                                          "string",
		"vendor.powerhal.init":                                                   "string",
		"vendor.primarydisplay.lhbm.frames_to_reach_peak_brightness":             "string",
		"vendor.ril.cbd.rfs_check_done":                                          "string",
		"vendor.ril.cdma.bssid0":                                                 "string",
		"vendor.ril.cdma.nid0":                                                   "string",
		"vendor.ril.cdma.sid0":                                                   "string",
		"vendor.ril.encrypted.pin.0":                                             "string",
		"vendor.ril.encrypted.pin.1":                                             "string",
		"vendor.ril.gsm.cid0":                                                    "string",
		"vendor.ril.gsm.data_cid0":                                               "string",
		"vendor.ril.gsm.sim.imsi_0":                                              "string",
		"vendor.ril.net.denied_roam_0":                                           "string",
		"vendor.ril.pin_len.0":                                                   "string",
		"vendor.ril.pin_len.1":                                                   "string",
		"vendor.ril.reset_count":                                                 "string",
		"vendor.ril.sim.carrier_id1":                                             "string",
		"vendor.rild.libpath":                                                    "string",
		"vendor.sys.diag.start_count":                                            "string",
		"vendor.sys.modem.logging.enable":                                        "string",
		"vendor.sys.modem.logging.skip":                                          "string",
		"vendor.sys.modem.logging.status":                                        "string",
		"vendor.thermal.link_ready":                                              "string",
		"vendor.usb.functions.ready":                                             "string",
		"vendor.usb.rndis.config":                                                "string",
		"vendor.wlan.driver.version":                                             "string",
		"vendor.wlan.firmware.version":                                           "string",
		"vendor.zram.size":                                                       "string",
		"vold.has_adoptable":                                                     "string",
		"vold.has_compress":                                                      "string",
		"vold.has_quota":                                                         "string",
		"vold.has_reserved":                                                      "string",
		"wifi.active.interface":                                                  "string",
		"wifi.aware.interface":                                                   "string",
		"wifi.direct.interface":                                                  "string",
		"wlan.driver.status":                                                     "enum ok unloaded",
		"zygote.critical_window.minute":                                          "int",
	}
)

//export FuzzMain
func FuzzMain(data *C.char, size C.int) {
	logger := util.NewLogger(util.InfoLevel)
	sizeInt := int(size)
	dataStr := C.GoStringN(data, size)
	name := maps.Keys(propNames)[rand.Intn(len(propNames))]
	valueType := propNames[name]
	var value string
	switch valueType {
	case "int":
		tmp := rand.Int63()
		if rand.Intn(2) == 1 {
			tmp = tmp * -1
		}
		value = strconv.FormatInt(tmp, 10)
	case "uint":
		value = strconv.FormatInt(rand.Int63(), 10)
	case "bool":
		if rand.Intn(2) == 1 {
			value = "true"
		} else {
			value = "false"
		}
	case "string":
		value = dataStr
	default:
		values := strings.Split(valueType, " ")
		if values[0] == "enum" {
			value = values[rand.Intn(len(values)-1)+1]
		} else {
			logger.Error("Unknown value type", util.Fields{"dataStr": dataStr, "sizeInt": sizeInt, "name": name, "value": value, "valueType": valueType})
		}
	}
	logger.Info("FuzzMain", util.Fields{"dataStr": dataStr, "sizeInt": sizeInt, "name": name, "value": value, "valueType": valueType})
	initPid := 1
	mprop := mprop.NewMProp(logger, initPid)
	err := mprop.Set(name, value)
	if err != nil {
		logger.Info("mprop set failed, please retry", util.Fields{"error": err, "name": name, "value": value})
	} else {
		logger.Info("mprop set success", util.Fields{"name": name, "value": value})
	}
}
func main() {

}
